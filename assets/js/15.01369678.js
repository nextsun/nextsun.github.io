(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{292:function(a,s,t){"use strict";t.r(s);var e=t(10),l=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"ansible-使用指南"}},[a._v("Ansible 使用指南")]),a._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#_1-安装"}},[a._v("1. 安装")])]),s("li",[s("a",{attrs:{href:"#_2-配置"}},[a._v("2. 配置")]),s("ul",[s("li",[s("a",{attrs:{href:"#ansible-cfg"}},[a._v("ansible.cfg")])]),s("li",[s("a",{attrs:{href:"#hosts"}},[a._v("hosts")])])])]),s("li",[s("a",{attrs:{href:"#_3-使用"}},[a._v("3. 使用")]),s("ul",[s("li",[s("a",{attrs:{href:"#_3-1-主机选择"}},[a._v("3.1 主机选择")])]),s("li",[s("a",{attrs:{href:"#_3-2-模块使用"}},[a._v("3.2 模块使用")])]),s("li",[s("a",{attrs:{href:"#_3-2-1-ping"}},[a._v("3.2.1  ping")])]),s("li",[s("a",{attrs:{href:"#_3-2-2-shell"}},[a._v("3.2.2  shell")])]),s("li",[s("a",{attrs:{href:"#_3-2-3-file"}},[a._v("3.2.3 file")])]),s("li",[s("a",{attrs:{href:"#_3-2-4-copy"}},[a._v("3.2.4 copy")])]),s("li",[s("a",{attrs:{href:"#_3-2-5-synchronize"}},[a._v("3.2.5 synchronize")])]),s("li",[s("a",{attrs:{href:"#_3-2-6-script"}},[a._v("3.2.6  script")])]),s("li",[s("a",{attrs:{href:"#_3-2-7-service"}},[a._v("3.2.7 service")])]),s("li",[s("a",{attrs:{href:"#_3-2-8-yum"}},[a._v("3.2.8  yum")])])])])])]),s("p"),a._v(" "),s("p",[a._v("该使用指南只作为快速参考手册，更多详细信息请参考\n"),s("a",{attrs:{href:"https://docs.ansible.com/ansible/2.9/index.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("官方文档"),s("OutboundLink")],1)]),a._v(" "),s("h2",{attrs:{id:"_1-安装"}},[a._v("1. 安装")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("yum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" epel-release\nyum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" ansible\n")])])]),s("h2",{attrs:{id:"_2-配置"}},[a._v("2. 配置")]),a._v(" "),s("p",[a._v("默认配置主目录为")]),a._v(" "),s("p",[a._v("/etc/ansible")]),a._v(" "),s("p",[a._v("基础配置文件参考如下")]),a._v(" "),s("h3",{attrs:{id:"ansible-cfg"}},[a._v("ansible.cfg")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#/etc/ansible/ansible.cfg")]),a._v("\n")])])]),s("h3",{attrs:{id:"hosts"}},[a._v("hosts")]),a._v(" "),s("div",{staticClass:"language-ini extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ini"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#/etc/ansible/hosts")]),a._v("\n\napp01\napp02\napp03\napp04\napp05\ndb01\ndb02\ndb03\nng01\nng02\n\n"),s("span",{pre:!0,attrs:{class:"token section"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("apps")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\napp[01:05]\n\n"),s("span",{pre:!0,attrs:{class:"token section"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("dbs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\ndb[01:03]\n\n"),s("span",{pre:!0,attrs:{class:"token section"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("ngs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\nng[01:02]\n\n")])])]),s("h2",{attrs:{id:"_3-使用"}},[a._v("3. 使用")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("主机选择表达式"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("模块名称"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"<模块参数>"')]),a._v("\n")])])]),s("h3",{attrs:{id:"_3-1-主机选择"}},[a._v("3.1 主机选择")]),a._v(" "),s("p",[a._v("更详细的信息请参考"),s("a",{attrs:{href:"https://docs.ansible.com/ansible/2.9/user_guide/intro_patterns.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("官方文档"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("通用主机表达式")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("描述")]),a._v(" "),s("th",[a._v("表达式")]),a._v(" "),s("th",[a._v("目标主机")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("全部主机")]),a._v(" "),s("td",[a._v("all (或者 *)")]),a._v(" "),s("td")]),a._v(" "),s("tr",[s("td",[a._v("某台主机")]),a._v(" "),s("td",[a._v("host1")]),a._v(" "),s("td")]),a._v(" "),s("tr",[s("td",[a._v("多台主机")]),a._v(" "),s("td",[a._v("host1:host2(或者host1,host2)")]),a._v(" "),s("td")]),a._v(" "),s("tr",[s("td",[a._v("某个小组")]),a._v(" "),s("td",[a._v("apps")]),a._v(" "),s("td")]),a._v(" "),s("tr",[s("td",[a._v("多个小组")]),a._v(" "),s("td",[a._v("apps:dbs")]),a._v(" "),s("td",[a._v("apps和dbs组的全部主机")])]),a._v(" "),s("tr",[s("td",[a._v("例外小组")]),a._v(" "),s("td",[a._v("apps:!ngs")]),a._v(" "),s("td",[a._v("apps组里面不在dbs的主机")])]),a._v(" "),s("tr",[s("td",[a._v("交集小组")]),a._v(" "),s("td",[a._v("apps:&ngs")]),a._v(" "),s("td",[a._v("同时在apps组和dbs组的主机")])])])]),a._v(" "),s("p",[a._v("也可以将其组合起来使用")]),a._v(" "),s("div",{staticClass:"language-ini extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ini"}},[s("code",[a._v("webservers:dbservers:&staging:!phoenix\n")])])]),s("p",[a._v("也可以使用通配符进行匹配")]),a._v(" "),s("div",{staticClass:"language-ini extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ini"}},[s("code",[a._v("192.0.\\*\n\\*.example.com\n\\*.com\napp*\ndb*\n")])])]),s("p",[a._v("使用示例")]),a._v(" "),s("ul",[s("li",[a._v("选择全部服务器")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible all "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ping")]),a._v("\n")])])]),s("ul",[s("li",[a._v("选择app01服务器")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible app01 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ping")]),a._v("\n")])])]),s("ul",[s("li",[a._v("选择所有应用服务器")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible apps "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ping")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#或者")]),a._v("\nansible app* "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ping")]),a._v("\n")])])]),s("ul",[s("li",[a._v("选择所有应用服务器和数据库服务器")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible apps,dbs "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ping")]),a._v("\n")])])]),s("h3",{attrs:{id:"_3-2-模块使用"}},[a._v("3.2 模块使用")]),a._v(" "),s("p",[a._v("使用ansible-doc命令可以查看模块手册\n如想查看shell模块的使用方法可允许如下命令")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible-doc shell\n")])])]),s("p",[a._v("按q退出手册")]),a._v(" "),s("p",[a._v("常用模块使用示例如下：")]),a._v(" "),s("h3",{attrs:{id:"_3-2-1-ping"}},[a._v("3.2.1  ping")]),a._v(" "),s("p",[a._v("ping 测试")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ping")]),a._v("\n")])])]),s("h3",{attrs:{id:"_3-2-2-shell"}},[a._v("3.2.2  shell")]),a._v(" "),s("ul",[s("li",[a._v("查看主机情况")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" shell "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"hostnamectl"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("查看cpu情况")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" shell "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"lscpu"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("查看内存情况")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" shell "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"free -g"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("查看磁盘情况")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" shell "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"df -Th"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("查看网络情况")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" shell "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ip addr"')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#或者")]),a._v("\nansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" shell "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ifconfig"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("查看tcp端口情况")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" shell "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"netstat -nltp"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("查看udp端口情况")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" shell "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"netstat -nlup"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("查看Java进程情况")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" shell "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jps -l"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("查看nginx进程情况")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" shell "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"systemctl status nginx"')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#或者")]),a._v("\nansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" shell "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ps -ef|grep nginx"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("查看mysql进程情况")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" shell "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"systemctl status mysqld"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("查看/data/pkgs/目录里面的文件")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" shell "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ls -al chdir=/data/pkgs/"')]),a._v("\n")])])]),s("h3",{attrs:{id:"_3-2-3-file"}},[a._v("3.2.3 file")]),a._v(" "),s("ul",[s("li",[a._v("创建目录")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("file")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"path=/data/pkgs/testdir state=directory mode=0755"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("修改目录权限和用户组")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("file")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"path=/data/pkgs/testdir state=directory mode=0644 owner=root group=root recurse=yes"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("创建文件")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("file")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"path=/data/pkgs/testdir/test.txt state=touch"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("修改文件权限和用户组")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("file")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"path=/data/pkgs/testdir/test.txt owner=root group=root mode=0644 "')]),a._v("\n")])])]),s("ul",[s("li",[a._v("创建链接文件")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("file")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"src=/data/pkgs/testdir/test.txt dest=/data/pkgs/testdir/test.link  state=link"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("删除文件")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("file")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"path=/data/pkgs/testdir/test.txt state=absent"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("删除目录")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("file")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"path=/data/pkgs/testdir state=absent"')]),a._v("\n")])])]),s("h3",{attrs:{id:"_3-2-4-copy"}},[a._v("3.2.4 copy")]),a._v(" "),s("ul",[s("li",[a._v("复制本地文件到主机")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" copy "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"src=/etc/resolv.conf dest=/data/pkgs/test.txt"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("复制本地文件到主机并备份目标文件")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" copy "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"src=/etc/resolv.conf dest=/data/pkgs/test.txt backup=yes"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("复制本地文件到主机并设置权限和用户组")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" copy "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"src=/etc/resolv.conf dest=/data/pkgs/test.txt owner=root group=root mode=0644"')]),a._v("\n")])])]),s("h3",{attrs:{id:"_3-2-5-synchronize"}},[a._v("3.2.5 synchronize")]),a._v(" "),s("ul",[s("li",[a._v("同步本机文件夹到远程主机")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" synchronize "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"src=/data/pkgs/testdir/ dest=/data/pkgs/testdir1/"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("同步远程主机文件夹到本机")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" synchronize "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"src=/data/pkgs/testdir/ dest=/data/pkgs/testdir3/ mode=pull"')]),a._v("\n")])])]),s("h3",{attrs:{id:"_3-2-6-script"}},[a._v("3.2.6  script")]),a._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[a._v("先创建本地测试脚本文件")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ps -ef |grep ssh"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" /data/pkgs/localscript.sh\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("\"print('hello python')\"")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" /data/pkgs/localscript.py\n")])])])]),a._v(" "),s("ul",[s("li",[a._v("在目标主机上执行本机shell脚本")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" script "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/data/pkgs/localscript.sh --some-argument 1234"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("在目标主机上执行本机python脚本")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" script "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/data/pkgs/localscript.py executable=python3"')]),a._v("\n")])])]),s("h3",{attrs:{id:"_3-2-7-service"}},[a._v("3.2.7 service")]),a._v(" "),s("ul",[s("li",[a._v("启动服务")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"name=httpd state=started"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("停止服务")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"name=httpd state=stopped"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("重启服务")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"name=httpd state=restarted"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("重新加载服务")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"name=httpd state=reloaded"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("设置为开机启动")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"name=httpd enabled=yes"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("取消开机启动")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"name=httpd enabled=no"')]),a._v("\n")])])]),s("h3",{attrs:{id:"_3-2-8-yum"}},[a._v("3.2.8  yum")]),a._v(" "),s("ul",[s("li",[a._v("使用yum安装软件")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" yum "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"name=sl"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("使用yum安装本地rpm包")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" yum "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"name=/data/pkgs/sl-5.02-1.el7.x86_64.rpm"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("使用yum安装在线rpm包")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" yum "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"name=http://nginx.org/packages/centos/8/x86_64/RPMS/nginx-1.22.1-1.el8.ngx.x86_64.rpm"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("仅下载安装包")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("\nansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" yum "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"name=sl state=latest download_only=true"')]),a._v("\n\nansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" yum "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"name=http://nginx.org/packages/centos/8/x86_64/RPMS/nginx-1.22.1-1.el8.ngx.x86_64.rpm download_only=true"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("指定包安装器")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#使用yum安装")]),a._v("\nansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" yum "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"name=sl use_backend=yum"')]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#使用dnf安装")]),a._v("\nansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" yum "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"name=sl use_backend=dnf"')]),a._v("\n")])])]),s("ul",[s("li",[a._v("使用yum卸载软件")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ansible localhost "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" yum "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"name=sl state=absent"')]),a._v("\n")])])]),s("p",[a._v(".")])])}),[],!1,null,null,null);s.default=l.exports}}]);